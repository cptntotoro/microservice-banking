# Сервис генерации курсов валют (Exchange Generator)

Exchange Generator Service — это stateless реактивный микросервис, предназначенный для генерации курсов валют в реальном времени и отправки их в сервис Exchange через REST-запросы с использованием API Gateway.

## Основные возможности

- Периодическая генерация курсов: Генерирует курсы для всех возможных валютных пар (включая кросс-курсы) каждую секунду с помощью задачи @Scheduled.
- Интеграция через REST: Отправляет сгенерированные курсы в формате JSON в сервис Exchange через API Gateway с использованием WebClient.
- Stateless-дизайн: Обеспечивает горизонтальную масштабируемость, отказоустойчивость и отсутствие необходимости в sticky sessions.

## Логика генерации курсов

- Расчет кросс-курсов: Для пар, не включающих RUB (например, USD → CNY), курс рассчитывается через RUB (targetRate/baseRate).
- Случайное отклонение: ±1% от рассчитанного курса для имитации рыночных колебаний.
- Спред: Разница 0.5% между ценой покупки (buy) и продажи (sell).
- Округление: Курсы округляются до 4 знаков после запятой с использованием режима HALF_UP.
- Частота: Генерация и отправка курсов каждую секунду (настраивается через exchange.rate.generation.interval.ms).

## Поддерживаемые валюты

- RUB (Российский рубль) - базовая для расчета кросс-курсов
- USD (Доллар США)
- EUR (Евро)
- CNY (Китайский юань)
- GBP (Британский фунт)
- JPY (Японская иена)

## Сборка и запуск

1. Убедитесь, что у вас запущен Docker Desktop
2. Соберите сервис (компиляция + тесты)

`mvn clean install -pl exchange-generator-service`

3. Запустите Consul:

`docker-compose -f docker-compose-consul.yml up -d consul-server`

4. Запустите сервис

`java -jar exchange-generator-service/target/exchange-generator-service.jar`